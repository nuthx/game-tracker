generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:../data/core.db"
}

// 设置
model Config {
  id                    Int          @id @default(autoincrement())
  username              String       @unique
  password              String
  psnNpsso              String       @default("")
  psnMonitorFromId      String       @default("")
  psnMonitorFromName    String       @default("")
  psnMonitorFromAvatar  String       @default("")
  psnMonitorToId        String       @default("")
  psnMonitorToName      String       @default("")
  psnMonitorToAvatar    String       @default("")
  psnMonitorInterval    Int          @default(30)
  createdAt             DateTime     @default(now())
  updatedAt             DateTime     @updatedAt
}

// 平台
model Platform {
  id                Int        @id @default(autoincrement())
  uname             String     @default("") @unique
  name              String     @default("") @unique
  color             String     @default("")
  games             Game[]
  records           Record[]
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
}

// 游戏
model Game {
  id                Int        @id @default(autoincrement())
  title             String     @default("") @unique
  titleAlias        String     @default("") @unique
  platform          Platform[]
  description       String     @default("")
  imageGrid         String     @default("")
  imageHero         String     @default("")
  imageLogo         String     @default("")
  imageIcon         String     @default("")
  releaseDate       DateTime?
  userRate          Int        @default(0)
  userStatus        Int        @default(0)  // 1: 想玩, 2: 在玩, 3: 玩过, 4: 抛弃
  userReview        String     @default("")
  userStartAt       DateTime?
  userEndAt         DateTime?
  userPlaySeconds   Int        @default(0)
  records           Record[]
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
}

// 游戏记录
model Record {
  id                Int        @id @default(autoincrement())
  platformId        Int
  platform          Platform   @relation(fields: [platformId], references: [id])
  gameId            Int
  game              Game       @relation(fields: [gameId], references: [id])
  player            String     @default("")
  startAt           DateTime   @default(now())
  endAt             DateTime   @default(now())
  playSeconds       Int        @default(0)
  hide              Int        @default(0)

  @@unique([startAt, endAt])
}
